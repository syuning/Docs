# **常用的 docker cli 命令行指令**

## **1. docker run**

> 官网文档地址：https://docs.docker.com/engine/reference/run/

Docker将进程运行在独立的的**容器**中，而**容器**是在主机(host)上运行的进程。主机可以是本地主机，也可以是远程主机。当docker用户执行docker run时，运行的容器进程是独立的，因为它具有自己的文件系统、自己的网络以及独立于主机的进程树。

### 一般形式

    docker run [OPTIONS] IMAGE[:TAG|@DIGEST] [COMMAND] [ARG...]

docker run命令必须要指定一个镜像(image)，用于派生容器。

镜像开发人员可以定义与镜像的*默认值*：

* 独立运行 或 前台运行
* 容器身份识别
* 网络设置
* CPU和内存的运行时限制

docker用户可以使用 ```docker run [OPTIONS]``` 来添加或覆盖开发人员设置的镜像默认设置，此外，docker用户还可以覆盖Docker运行时本身设置的几乎所有默认设置。docker用户拥有覆盖镜像和Docker运行时默认值的能力，这就是为什么run具有比其他任何docker命令更多的选项的原因。

### 用户专用选项

只有docker用户才能设置以下选项：

* 独立运行 或 前台运行
* 容器身份识别
* IPC设置
* 网络设置
* 重新启动策略
* 清理
* 资源的运行时限制
* 运行时特权和Linux功能


### **独立运行 与 前台运行**

#### 独立运行


    docker run -d=true 
或
    
    docker run -d

以独立模式启动的容器，会在**用于运行容器的根进程退出时**退出。

如果在docker run中将-d与--rm一起使用，则在**容器退出或守护进程退出时**将容器删除。

不要将```service [服务名] start```命令传递给独立运行的容器，如尝试启动nginx服务（ docker run -d -p 80:80 my_image service nginx start），此时由于根进程（service nginx start）返回，因此容器自动停止。若要启动此类web服务器之类的进程，请执行以下操作：

    $ docker run -d -p 80:80 my_image nginx -g 'daemon off;'

由于独立运行的容器不再监听docker run运行时所在的命令行，因此若要使用独立运行的容器进行输入、输出，请使用网络连接或共享卷。

若要重新附加到分离的容器，请使用 ```docker attach``` 命令。

#### 前台运行

当不指定-d运行docker run时，默认容器将在前台运行。docker run可以在容器中启动进程，并将控制台绑定到到进程的标准输入、输出和标准错误。它甚至可以假装为TTY并传递信号。

以下选项都是可配置的：


1. **-a=[]**: 绑定到 `STDIN`, `STDOUT` and/or `STDERR`

默认情况下docker会将stdout和stderr同时绑定到控制台，你也可以随意指定这三个中的任意一个或多个，如：

```
$ docker run -a stdin -a stdout -i -t ubuntu /bin/bash
```

2. **-t**: 配置一个伪终端 (pseudo-tty)

3. **--sig-proxy=true**: Proxy all received signals to the process (non-TTY mode only)

4. **-i**: Keep STDIN open even if not attached

对于交互式进程（如shell），必须 -i 和 -t 一起使用才能为容器进程分配 tty。-i -t 通常可以写为 -it，在后面的示例中将会出现。当客户端从管道接收其标准输入时，禁止使用it，如：

```
$ echo test | docker run -i busybox cat
```

### 容器身份识别

#### 容器名称 [--name]

docker用户可以通过三种方式来鉴别一个容器：
1. UUID 长id - “f78375b1c487e03c9438c729345e54db9d20cfa2ac1fc3494b6eb60872e74778”
2. UUID 短id - “f78375b1c487”
3. 名称 - “evil_ptolemy”

## **2. 其他命令**

指令 | 常用选项 | 描述 | 文档链接
---- | ---- | ---- | ----
docker run |  | 在容器中运行进程 | 